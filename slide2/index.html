<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Análisis Multivariados en R - 2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Irwing S. Saldaña" />
    <meta name="author" content="Departamento de Ecoinformática y Biogeografía" />
    <meta name="author" content="Instituto de Ciencias Antonio Brack" />
    <meta name="date" content="2021-01-01" />
    <script src="assets/header-attrs/header-attrs.js"></script>
    <link href="assets/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: title-slide, middle, center

# &lt;span style = 'font-size: 110%;color:#5f00db;'&gt;Análisis Multivariados en R&lt;/span&gt;
## &lt;span style = 'font-size: 75%;color:#212121;'&gt;Curso Colaborativo IIAP - UNAMAD&lt;/span&gt;
### &lt;span style = 'font-size: 85%;color:#212121;'&gt;Irwing S. Saldaña&lt;/span&gt;
### &lt;span style = 'font-size: 80%; color:#919191; font-weight:lighter;'&gt;[Instituto de Ciencias Antonio Brack](https://www.brackinstitute.com/)&lt;br&gt;Departamento de Ecoinformática y Biogeografía&lt;br&gt;Perú, 2021&lt;/span&gt;



&lt;style type="text/css"&gt;
/* Footnote */
.remark-slide-content:after {
    content: "Blgo. Irwing S. Saldaña | Instituto de Ciencias Antonio Brack, Perú";
    opacity: 0.9;
    position: absolute;
    text-align: left;
    height: 26px;
    font-size: 12pt;
    left: 120px;
    bottom: 18px;
    font-weight: normal;
    width: 1200px;
}

.scroll-box-8 {
  height:8em;
  overflow-y: scroll;
}
.scroll-box-10 {
  height:10em;
  overflow-y: scroll;
}
.scroll-box-12 {
  height:12em;
  overflow-y: scroll;
}
.scroll-box-14 {
  height:14em;
  overflow-y: scroll;
}
.scroll-box-16 {
  height:16em;
  overflow-y: scroll;
}
.scroll-box-18 {
  height:18em;
  overflow-y: scroll;
}
.scroll-box-19 {
  height:19em;
  overflow-y: scroll;
}
.scroll-box-22 {
  height:22em;
  overflow-y: scroll;
}
.scroll-output {
  height: 80%;
  overflow-y: scroll;
}
&lt;/style&gt;

---
class: inverse, middle, center 
background-image: url(figs/fondo.jpg)
background-size: cover
background-position: top

&lt;img src="figs/aboutme.png" width="25%" style="display: block; margin: auto;" /&gt;

### Blgo. Irwing S. Saldaña &lt;br&gt;&lt;span style= 'font-size:80%; font-weigth: light;'&gt; Instructor&lt;/span&gt;
&lt;span style= 'font-family: calibri; color: white'&gt;Dpto. de Ecoinformática y Biogeografía,&lt;br&gt;
Instituto de Ciencias Antonio Brack, Perú&lt;/span&gt;

.white[[Website](https://www.brackinstitute.com/)|[ ResearchGate ](https://www.researchgate.net/profile/Irwing-Saldana)|[ Linkedin ](https://www.linkedin.com/in/irssald/)|[ R Latam Blog ](https://rlatam.blog/)]|[ Github ](https://github.com/irwingss)

---
class: inverse, middle, center , animated, slideInRight

# Análisis Canónico

[ Análisis Multivariados con restricciones o constreñidos ]

---

# Análisis Canónico

&lt;img src="figs/canonico.jpg" width="100%" style="display: block; margin: auto;" /&gt;

---

# Recordemos el Análisis de Correspondencia

Implica métodos en los que constreñimos o condicionamos una matriz de datos Y (normalmente de biodiversidad) con una matriz de datos X (normalmente de ambientales). Recordemos el análisis de correspondencia (CA):


```r
tm &lt;- openxlsx::read.xlsx("bases/tabla_multivariada.xlsx")
tm
```

.scroll-box-14[
<div id="fyemgqtraw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fyemgqtraw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fyemgqtraw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fyemgqtraw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fyemgqtraw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fyemgqtraw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fyemgqtraw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fyemgqtraw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fyemgqtraw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fyemgqtraw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fyemgqtraw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fyemgqtraw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fyemgqtraw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fyemgqtraw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fyemgqtraw .gt_from_md > :first-child {
  margin-top: 0;
}

#fyemgqtraw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fyemgqtraw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fyemgqtraw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fyemgqtraw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyemgqtraw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fyemgqtraw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyemgqtraw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fyemgqtraw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fyemgqtraw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fyemgqtraw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fyemgqtraw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fyemgqtraw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fyemgqtraw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fyemgqtraw .gt_left {
  text-align: left;
}

#fyemgqtraw .gt_center {
  text-align: center;
}

#fyemgqtraw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fyemgqtraw .gt_font_normal {
  font-weight: normal;
}

#fyemgqtraw .gt_font_bold {
  font-weight: bold;
}

#fyemgqtraw .gt_font_italic {
  font-style: italic;
}

#fyemgqtraw .gt_super {
  font-size: 65%;
}

#fyemgqtraw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Arctlute</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pardlugu</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Zoraspin</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pardnigr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pardpull</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">AuIoalbi</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Trocterr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Alopcune</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pardmont</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Alopacce</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Alopfabr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Arctperi</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
]

---

# Recordemos el Análisis de Correspondencia

Implica métodos en los que constreñimos o condicionamos una matriz de datos Y (normalmente de biodiversidad) con una matriz de datos X (normalmente de ambientales). Recordemos el análisis de correspondencia (CA):


```r
library(ca)
especies_log &lt;- log1p(especies)
CA &lt;-ca(especies_log)
*summary(CA)
```

.scroll-box-12[

```
## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.558173  53.7  53.7  *************            
##  2      0.231494  22.3  76.0  ******                   
##  3      0.117723  11.3  87.4  ***                      
##  4      0.038470   3.7  91.1  *                        
##  5      0.027822   2.7  93.7  *                        
##  6      0.020580   2.0  95.7                           
##  7      0.016650   1.6  97.3                           
##  8      0.010426   1.0  98.3                           
##  9      0.008998   0.9  99.2                           
##  10     0.005088   0.5  99.7                           
##  11     0.003190   0.3 100.0                           
##         -------- -----                                 
##  Total: 1.038615 100.0                                 
## 
## 
## Rows:
##      name   mass  qlt  inr     k=1 cor ctr    k=2 cor ctr  
## 1  |  ua1 |   16  902   33 |   520 123   8 | 1309 779 117 |
## 2  |  ua2 |   21  930   29 |   537 202  11 | 1018 728  96 |
## 3  |  ua3 |   19  964   35 |   535 149  10 | 1249 815 127 |
## 4  |  ua4 |   23  843   25 |   537 253  12 |  820 590  67 |
## 5  |  ua5 |   12  714   23 |   499 127   6 | 1072 587  62 |
## 6  |  ua6 |   16  839   33 |   494 111   7 | 1269 728 109 |
## 7  |  ua7 |   47  480   25 |   492 447  21 | -134  33   4 |
## 8  |  ua8 |   39  670   30 |   491 298  17 |  549 373  51 |
## 9  |  ua9 |   25  814   29 |   458 176   9 |  872 638  82 |
## 10 | ua10 |   62  678   20 |   431 550  21 | -208 128  12 |
## 11 | ua11 |   55  621   28 |   446 370  20 | -367 251  32 |
## 12 | ua12 |   54  660   19 |   443 552  19 | -196 108   9 |
## 13 | ua13 |   62  774   17 |   400 579  18 | -232 195  15 |
## 14 | ua14 |   71  638   28 |   384 359  19 | -338 279  35 |
## 15 | ua15 |   71  755   12 |   283 444  10 | -237 312  17 |
## 16 | ua16 |   65  629    9 |   125 115   2 | -266 514  20 |
## 17 | ua17 |   59  545   15 |   126  59   2 | -361 485  33 |
## 18 | ua18 |   21  265   21 |   -44   2   0 | -522 264  24 |
## 19 | ua19 |   38  197   28 |   -88  10   1 | -377 187  23 |
## 20 | ua20 |   44  220   16 |  -285 219   6 |   23   1   0 |
## 21 | ua21 |   32  338   25 |  -370 167   8 | -375 171  19 |
## 22 | ua22 |   15  300   29 |  -706 246  13 | -331  54   7 |
## 23 | ua23 |   23  925   49 | -1440 925  85 |  -35   1   0 |
## 24 | ua24 |   29  974   60 | -1422 938 104 |  277  36  10 |
## 25 | ua25 |   20  887   58 | -1637 882  96 |  120   5   1 |
## 26 | ua26 |   22  965   87 | -1982 964 156 |   50   1   0 |
## 27 | ua27 |   21  976   89 | -2056 973 162 |  107   3   1 |
## 28 | ua28 |   17  729  126 | -2264 682 160 |  597  47  27 |
## 
## Columns:
##       name   mass  qlt  inr     k=1 cor ctr    k=2 cor ctr  
## 1  | Arctl |   24  356   39 |   498 146  11 | -596 210  37 |
## 2  |  Prdl |   70  944  133 |   501 127  31 | 1272 817 487 |
## 3  |  Zrsp |   86  515   41 |   495 500  38 |   86  15   3 |
## 4  |  Prdn |   91  693   37 |   413 399  28 | -354 294  49 |
## 5  |  Prdp |  100  776   48 |   409 337  30 | -467 439  94 |
## 6  |  AIlb |   68  547   40 |   420 292  22 | -393 255  46 |
## 7  |  Trct |  188  815   55 |   289 273  28 |  407 542 134 |
## 8  | Alpcn |   83  398   28 |   374 393  21 |  -38   4   1 |
## 9  |  Prdm |  122  377   72 |  -228  84  11 | -424 293  95 |
## 10 | Alpcc |   86  819  107 | -1003 779 155 | -227  40  19 |
## 11 |  Alpf |   56  920  183 | -1769 915 312 |  138   6   5 |
## 12 | Arctp |   27  810  217 | -2530 778 314 |  519  33  32 |
```
]

---
class: inverse, middle, center , animated, slideInRight

# Análisis de Correspondencia Canónica (CCA)

[ Incorporando una matriz X en el análisis de CA ]

---

# Análisis de Correspondencia Canónica (CCA)

--

El CCA es la versión constreñida del CA.

--

Se crea utilizando la función .purple[`cca()`]

--

Estructura del código en R:


```r
# Modo solo matrices 
CCA &lt;- cca(matriz_X, matriz_Y)

# Modo fórmula (mucho más versátil)
CCA &lt;- cca(matriz_Y ~ ., data= matriz_X)
```

--

 - Utiliza distancias de **Chi cuadrado.**
 - Recuerda que las _especies raras se ven sobreexpresadas_ (**logaritmizar** para reducir el peso de ellas).
 - Sirve para **identificar la proporción de varianza** de una matriz de biodiversidad (matriz de conteos) que es **explicada** por una matriz de datos ambientales (matriz de mediciones).

---

# Análisis de Correspondencia Canónica (CCA)


```r
ambiente &lt;- read.csv("bases/cca_env.csv", row.names=1, sep=";")
CCA &lt;- cca(especies_log ~ ., data = ambiente)
summary(CCA)
```

.scroll-box-18[

```
## 
## Call:
## cca(formula = especies_log ~ WaterContent + BareSand + CoverMoss +      LightReflection + FallenTwigs + CoverHerbs, data = ambiente) 
## 
## Partitioning of scaled Chi-square:
##               Inertia Proportion
## Total          1.0386     1.0000
## Constrained    0.7695     0.7409
## Unconstrained  0.2691     0.2591
## 
## Eigenvalues, and their contribution to the scaled Chi-square 
## 
## Importance of components:
##                        CCA1   CCA2    CCA3    CCA4     CCA5     CCA6    CA1
## Eigenvalue            0.510 0.1982 0.04310 0.01244 0.004102 0.001689 0.1110
## Proportion Explained  0.491 0.1908 0.04149 0.01198 0.003950 0.001627 0.1069
## Cumulative Proportion 0.491 0.6819 0.72335 0.73532 0.739273 0.740900 0.8478
##                           CA2     CA3     CA4     CA5     CA6     CA7      CA8
## Eigenvalue            0.04569 0.02913 0.02449 0.01675 0.01440 0.01261 0.007096
## Proportion Explained  0.04399 0.02804 0.02358 0.01612 0.01387 0.01214 0.006832
## Cumulative Proportion 0.89176 0.91981 0.94339 0.95951 0.97338 0.98552 0.992348
##                            CA9     CA10     CA11
## Eigenvalue            0.004073 0.002574 0.001300
## Proportion Explained  0.003922 0.002478 0.001252
## Cumulative Proportion 0.996270 0.998748 1.000000
## 
## Accumulated constrained eigenvalues
## Importance of components:
##                         CCA1   CCA2   CCA3    CCA4     CCA5     CCA6
## Eigenvalue            0.5100 0.1982 0.0431 0.01244 0.004102 0.001689
## Proportion Explained  0.6627 0.2576 0.0560 0.01617 0.005331 0.002195
## Cumulative Proportion 0.6627 0.9203 0.9763 0.99247 0.997805 1.000000
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## 
## 
## Species scores
## 
##             CCA1     CCA2     CCA3     CCA4      CCA5       CCA6
## Arctlute  0.5485 -0.58841  0.49480 -0.20051  0.089424  0.0427550
## Pardlugu  0.5284  1.20027 -0.11027  0.04306 -0.072721 -0.0077984
## Zoraspin  0.4996  0.04446  0.29446 -0.08563 -0.078672 -0.0101251
## Pardnigr  0.3837 -0.32546  0.18820  0.06719  0.016105 -0.0292493
## Pardpull  0.4220 -0.46894 -0.05300  0.03512  0.004908 -0.0762695
## AuIoalbi  0.4296 -0.36089  0.08001  0.25542 -0.069771  0.0761089
## Trocterr  0.2882  0.33478 -0.02292 -0.06367  0.038116  0.0002648
## Alopcune  0.3270  0.03121 -0.19623  0.07306  0.142572  0.0428824
## Pardmont -0.3176 -0.36629 -0.22871 -0.17331 -0.038176  0.0270985
## Alopacce -1.0106 -0.18789 -0.28601  0.08163 -0.048849 -0.0242917
## Alopfabr -1.7037  0.16793  0.31993 -0.01405 -0.009070  0.0485173
## Arctperi -2.1960  0.50201  0.30922  0.10119  0.105486 -0.0750229
## 
## 
## Site scores (weighted averages of species scores)
## 
##         CCA1     CCA2      CCA3    CCA4    CCA5     CCA6
## ua1   0.7797  2.83890 -0.008129 -2.6833 -3.7595  -2.3261
## ua2   0.7859  2.26691 -0.182101 -0.2349  0.1809  -1.0933
## ua3   0.7904  2.78228 -0.781864 -0.9780 -0.3128   1.0452
## ua4   0.7834  1.79008  0.707470 -1.3488 -0.4574  -1.3547
## ua5   0.7423  2.26952  0.535718 -3.7555 -1.8061  -2.0279
## ua6   0.7262  2.82832 -1.809184 -0.6655  4.7718   2.6372
## ua7   0.7107 -0.37081  0.847280  2.5907 -2.4506  -1.8349
## ua8   0.7065  1.26011 -0.948374  2.5346 -0.2651   5.4888
## ua9   0.6630  1.94028 -1.352924 -1.7090 -1.7841  -2.3094
## ua10  0.6159 -0.50304  0.789964  1.7045  1.8265  -2.2126
## ua11  0.6306 -0.88119  1.603798 -1.4242  1.9666   0.9386
## ua12  0.6321 -0.51216  0.979319 -0.9552 -1.3515  -3.0910
## ua13  0.5706 -0.56985  0.720232  0.9961 -0.5962  -1.6296
## ua14  0.5440 -0.80411  1.079642 -0.4322  0.5932   0.2763
## ua15  0.3927 -0.54111  0.455948  0.8225  1.2797   1.5922
## ua16  0.1589 -0.58739 -0.533116  1.0183  1.3238   1.4948
## ua17  0.1440 -0.81325 -1.341788  0.6680 -0.3253  -2.0670
## ua18 -0.1519 -1.11136 -3.150019 -3.6939  0.7626   0.2387
## ua19 -0.1966 -0.79212 -3.473157 -1.6566  2.9758  -1.1627
## ua20 -0.4330  0.08938  0.217649 -0.5872 -3.5576   5.5314
## ua21 -0.5973 -0.78093 -2.889256 -1.8245 -2.6871   6.5889
## ua22 -1.1042 -0.65930 -2.610992 -6.9136 -5.4578  10.4366
## ua23 -2.0441  0.02896 -0.211175 -1.1784 -2.1924   2.7152
## ua24 -1.9712  0.73034 -0.006430  0.3033 -1.4725  -2.5978
## ua25 -2.2936  0.37748  1.291737 -0.1476 -0.5936   3.6485
## ua26 -2.7454  0.25360  0.694581  2.3818 -0.3537  -5.1989
## ua27 -2.8397  0.38545  1.649242  1.8533  0.5484  -2.7711
## ua28 -3.0022  1.43348  4.172071  3.3695 10.0153 -12.8588
## 
## 
## Site constraints (linear combinations of constraining variables)
## 
##          CCA1    CCA2    CCA3     CCA4     CCA5    CCA6
## ua1   1.13112  1.3287 -0.2874 -0.12496  0.27715  0.9001
## ua2   0.58923  1.9541 -0.5009 -0.96597 -0.49706 -0.2661
## ua3   0.58587  2.3419  0.1706 -1.41668  0.81856 -1.3338
## ua4   0.58587  2.3419  0.1706 -1.41668  0.81856 -1.3338
## ua5   1.03949  1.3514 -0.5007  0.02058  0.86119  1.0465
## ua6   0.88406  1.8190 -0.4437  0.88360  0.60319  0.8554
## ua7   0.96075 -0.2193  0.1986  0.46655 -0.73753  0.1687
## ua8   0.71938  1.8419 -0.9611  1.36385 -1.39643  1.3240
## ua9   0.60910  2.3235 -0.1166 -0.25068 -0.20045 -0.5604
## ua10  0.70286 -0.3489  0.9283  0.88863  0.52581 -1.2137
## ua11  0.55813 -0.4464  0.9719 -2.26110 -0.65834  2.2793
## ua12  0.93799 -1.1560  0.7995 -0.97856 -1.81955 -1.0645
## ua13  0.23081 -0.6841 -0.5160  0.25670 -0.44430 -0.4196
## ua14  0.69292 -0.5336  0.7362  0.53099  0.37750 -1.0666
## ua15  0.43083 -0.5400  0.6265  0.51315  2.21226  1.4329
## ua16  0.04756 -0.6387 -0.9425  0.54777  0.72378 -0.1268
## ua17 -0.13768 -0.7253 -1.4619  0.33786  0.02086  0.1235
## ua18 -0.34884 -0.6656 -1.4050 -1.51391  0.05926 -0.9547
## ua19 -0.24192 -0.7594 -1.5781 -0.35010  0.17891 -0.1380
## ua20 -1.02851  0.1151  2.1692  1.46503 -1.35832  0.2758
## ua21 -0.51153 -0.5106 -1.8294 -0.53268 -0.06936 -0.4436
## ua22 -1.58352 -0.6759  1.2497 -1.51218  0.99731  0.5291
## ua23 -2.04772  0.2247  0.1231  0.61127 -1.10225  0.6485
## ua24 -2.03637  0.1672 -0.6002  0.52843 -0.68618  0.6815
## ua25 -2.45810  0.6608  0.5220 -2.23364  0.99387 -1.6125
## ua26 -1.82190  0.4337 -0.5127  0.86981 -1.14158  0.1274
## ua27 -1.91285 -0.3524  0.0640 -0.94191  0.45246  0.6213
## ua28 -2.70262  1.3798  1.6180  0.60759  1.33978 -0.9073
## 
## 
## Biplot scores for constraining variables
## 
##                    CCA1     CCA2      CCA3    CCA4      CCA5     CCA6
## WaterContent     0.9412 -0.05878  0.171677 -0.1482  0.228468  0.08409
## BareSand        -0.7758  0.03036  0.500023 -0.1093 -0.005238  0.36763
## CoverMoss       -0.6749 -0.32340 -0.521693 -0.3451 -0.212601  0.05912
## LightReflection -0.6682 -0.53424 -0.271926  0.2748  0.338951 -0.06130
## FallenTwigs      0.4453  0.76908 -0.005876 -0.2499  0.003712  0.38434
## CoverHerbs       0.2998 -0.80936 -0.026541  0.4910 -0.075337  0.08702
```
]

---

# Test de Permutaciones: modelo

-  Necesario para validar si la varianza explicada por la matriz ambiental explica más de lo que podría explicar por azar.

.scroll-box-18[

```r
# Probando la significancia del modelo CCA:
*anova.cca(CCA)
```

```
## Permutation test for cca under reduced model
## Permutation: free
## Number of permutations: 999
## 
## Model: cca(formula = especies_log ~ WaterContent + BareSand + CoverMoss + LightReflection + FallenTwigs + CoverHerbs, data = ambiente)
##          Df ChiSquare      F Pr(&gt;F)    
## Model     6   0.76951 10.008  0.001 ***
## Residual 21   0.26911                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]

---

# Test de Permutaciones: términos

-  Necesario para validar si la varianza explicada por la matriz ambiental explica más de lo que podría explicar por azar.

.scroll-box-18[

```r
# Probando la significancia de los término (variables ambientales):
*anova.cca(CCA, by="terms")
```

```
## Permutation test for cca under reduced model
## Terms added sequentially (first to last)
## Permutation: free
## Number of permutations: 999
## 
## Model: cca(formula = especies_log ~ WaterContent + BareSand + CoverMoss + LightReflection + FallenTwigs + CoverHerbs, data = ambiente)
##                 Df ChiSquare       F Pr(&gt;F)    
## WaterContent     1   0.45422 35.4459  0.001 ***
## BareSand         1   0.06130  4.7839  0.007 ** 
## CoverMoss        1   0.07015  5.4744  0.003 ** 
## LightReflection  1   0.08363  6.5261  0.002 ** 
## FallenTwigs      1   0.07245  5.6537  0.002 ** 
## CoverHerbs       1   0.02775  2.1657  0.099 .  
## Residual        21   0.26911                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]

---

# Test de Permutaciones: ejes canónicos

-  Necesario para validar si la varianza explicada por la matriz ambiental explica más de lo que podría explicar por azar.

.scroll-box-18[

```r
# Probando la significancia de los ejes CCA (CCA1 y CCA2 al menos deben ser significativos):
*anova.cca(CCA, by="axis")
```

```
## Permutation test for cca under reduced model
## Forward tests for axes
## Permutation: free
## Number of permutations: 999
## 
## Model: cca(formula = especies_log ~ WaterContent + BareSand + CoverMoss + LightReflection + FallenTwigs + CoverHerbs, data = ambiente)
##          Df ChiSquare       F Pr(&gt;F)    
## CCA1      1   0.50998 39.7973  0.001 ***
## CCA2      1   0.19820 15.4667  0.001 ***
## CCA3      1   0.04310  3.3630  0.168    
## CCA4      1   0.01244  0.9708  0.908    
## CCA5      1   0.00410  0.3201  0.999    
## CCA6      1   0.00169  0.1318  1.000    
## Residual 21   0.26911                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]

---

# Gráfico Final CCA


```r
library(ggvegan)
autoplot(CCA)
```
&lt;img src="index_files/figure-html/unnamed-chunk-15-1.png" width="75%" style="display: block; margin: auto;" /&gt;

---
class: inverse, middle, center , animated, slideInRight

# Análisis de Redundancia (RDA)

[ La extensión canónica del PCA ]

---

# Análisis de Redundancia (RDA)

--

El RDA es la versión constreñida del PCA.

--

Se crea utilizando la función .purple[`rda()`]

--

Estructura del código en R:


```r
# Modo solo matrices 
RCA &lt;- rca(matriz_X, matriz_Y)

# Modo fórmula (mucho más versátil)
RCA &lt;- rca(matriz_Y ~ ., data= matriz_X)
```

--

 - Utiliza distancias **Euclideanas.** Pero se puede utilizar la misma propiedad de las distancias de Hellinger o distancias Chord que en el PCA.
 - Igual que el CCA sirve para **identificar la proporción de varianza** de una matriz de dependiente (matriz de conteos o "biodiversidad" pero transformada, o una matriz de mediciones) que es **explicada** por una matriz de datos independientes (matriz de mediciones).


---

# Tipos de Análisis de Redundancia (RDA)

--

- **RDA clásico (con distancias euclideanas)**

  - Usa PCA como motor de análisis multivariado
  - Trabaja con regresiones múltiples también

--

- **RDA basado en transformaciones (tb-RDA)**

  - Usa PCA como motor de análisis multivariado
  - Trabaja con regresiones múltiples también
  
--

- **RDA basado en distancias (db-RDA)**

  - Usa PCoA (MDS) como motor de análisis multivariado
  - Trabaja con regresiones múltiples también
  - Se requiere evitar eigenvalores negativos (aplicar raiz cuadrada a las distancias Bray Curtis para este fin)
--

.right[#### .red[...Veamos la estrategia de proyección del RDA]]

---
class: middle


&lt;img src="figs/RDA1.jpg" width="70%" style="display: block; margin: auto;" /&gt;

--

&lt;img src="figs/RDA2.jpg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: middle

--

&lt;img src="figs/RDA3.jpg" width="70%" style="display: block; margin: auto;" /&gt;

--

&lt;img src="figs/RDA4.jpg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: middle

--

&lt;img src="figs/RDA5.jpg" width="70%" style="display: block; margin: auto;" /&gt;

---

# Recomendaciones

-  Piensa en el RDA como si fueras a realizar un PCA.

- Cumple con los requerimientos del PCA, transforma las matrices si se requiere, o estandariza si es necesario.


```r
# Si se requiere escalar o no, se activa o desactiva este argumento
rda(..., scale=TRUE)
```


- Si la matriz dependiente es de abundancias: aplica tb-RDA o db-RDA


```r
# RDA basado en transformaciones
rda(..., scale=FALSE)

# RDA basado en distancias
dbrda(..., distance = "bray")
```


---

# Recomendaciones

- Recuerda que no toda la varianza de la matriz Y es explicada por la matriz X, así que busquemos valores altos de varianza constreñida.

- Caso contrario, no es correcto hacer una análisis canónico, sino un no restringido, o con regresiones lineales (o generalizadas) múltiples.

- No pueden haber igual o más variables explicativas que observaciones.



---

# Escalas

-   `scaling = 1` `\(\implies\)` Se centra en sitios (filas), escala los scores de los sitios por `\(\lambda_i\)`
-   `scaling = 2` `\(\implies\)` Se centra en especies (columnas Y), escala los scores de las especies por `\(\lambda_i\)`
-   `scaling = 3` `\(\implies\)` Escalado simétrico, escala ambos scores por `\(\sqrt{\lambda_i}\)`
-   `scaling = 0` `\(\implies\)` scores crudos


```r
# Observar scores individuales
scores(RDA, choices = 1:2, display = "species", scaling = 3)
```

-   `scaling = 1` `\(\implies\)` "sites"
-   `scaling = 2` `\(\implies\)` "species"
-   `scaling = 3` `\(\implies\)` "symmetric"
-   `scaling = 0` `\(\implies\)` "none"

---

.pull-left[
# Sites &lt;br&gt;`scaling = 1`

- Las distancias entre las observaciones son aproximadamente euclideanas. Objetos cercanos se asumen continene variables con similar valor.

- La distancia en ángulos rectos entre las observaciones y las variables (X o Y) reflejan que están asociados a ellos.

- Los ángulos entre las variables de la matriz Y no son interpretables.

- El coseno de los ángulos entre los vectores de las variables de la matriz Y y X reflejan su nivel de correlación (e.g. cos(90*pi/180) = 0, cos(20*pi/180) =  0.94).
]

.pull-right[
&lt;img src="figs/rda scaling 1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---

.pull-left[
# Species &lt;br&gt;`scaling = 2`

- Las distancias entre las observaciones no son euclideanas.

- La distancia en ángulos rectos entre las observaciones y las variables (X o Y) reflejan que están asociados a ellos.

- El coseno de los ángulos entre todos los vectores (X o Y) reflejan su nivel de correlación (e.g. cos(90*pi/180) = 0, cos(20*pi/180) =  0.94).
]

.pull-right[
&lt;img src="figs/rda scaling 2.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
.pull-left[

#### Species `scaling = 3`

&lt;img src="figs/rda scaling 3.png" width="80%" style="display: block; margin: auto;" /&gt;
]

.pull-right[

#### Species `scaling = 0`

&lt;img src="figs/rda scaling 0.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse, middle, center , animated, slideInRight

# Modelamiento de RDA 

[ También aplicado al CCA ]

---

# Modelamiento con RDA - CCA

Dado que estos métodos utilizan regresiones lineales en segundo plano para poder hacer el ajuste del modelo, las mismas recomendaciones que para un LM se deben aplicar aquí.

- Identificar las variables importantes y solo incluirlas a ellas.

- Si se conoce que la relación entre una variable y las especies tiene **comportamiento cuadrático o cúbico**, se puede incluir ello en la fórmula del modelo RDA.

- Si se sabe que **dos variables interactúan** y que dicha interacción influencia a la presencia de especies, también se puede incluir ello en la fórmula del modelo RDA.

- Procedimientos de **selección automática de variables** deben ser consideradas con cuidado.

---


```r
library(vegan)
data("varespec")
data("varechem")
*RDA_vare &lt;- rda(decostand(varespec, "hellinger") ~ Al + K + Baresoil, data = varechem)
RDA_vare
```

```
## Call: rda(formula = decostand(varespec, "hellinger") ~ Al + K +
## Baresoil, data = varechem)
## 
##               Inertia Proportion Rank
## Total          0.3647     1.0000     
## Constrained    0.1319     0.3616    3
## Unconstrained  0.2328     0.6384   20
## Inertia is variance 
## 
## Eigenvalues for constrained axes:
##    RDA1    RDA2    RDA3 
## 0.10019 0.02541 0.00625 
## 
## Eigenvalues for unconstrained axes:
##     PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8 
## 0.08502 0.03623 0.02715 0.02268 0.01208 0.01067 0.00998 0.00701 
## (Showing 8 of 20 unconstrained eigenvalues)
```

---


```r
library(vegan)
data("varespec")
data("varechem")
*RDA_vare &lt;- rda(decostand(varespec, "hellinger") ~ Al + P + K + Baresoil, data = varechem)
RDA_vare
```

```
## Call: rda(formula = decostand(varespec, "hellinger") ~ Al + P + K +
## Baresoil, data = varechem)
## 
##               Inertia Proportion Rank
## Total          0.3647     1.0000     
## Constrained    0.1494     0.4098    4
## Unconstrained  0.2152     0.5902   19
## Inertia is variance 
## 
## Eigenvalues for constrained axes:
##    RDA1    RDA2    RDA3    RDA4 
## 0.10067 0.02863 0.01501 0.00513 
## 
## Eigenvalues for unconstrained axes:
##     PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8 
## 0.08319 0.03445 0.02427 0.01639 0.01160 0.01047 0.00943 0.00639 
## (Showing 8 of 19 unconstrained eigenvalues)
```

---


```r
library(vegan)
data("varespec")
data("varechem")
*RDA_vare &lt;- rda(decostand(varespec, "hellinger") ~ Al + P*(K + Baresoil), data = varechem)
RDA_vare
```

```
## Call: rda(formula = decostand(varespec, "hellinger") ~ Al + P * (K +
## Baresoil), data = varechem)
## 
##               Inertia Proportion Rank
## Total          0.3647     1.0000     
## Constrained    0.1968     0.5395    6
## Unconstrained  0.1679     0.4605   17
## Inertia is variance 
## 
## Eigenvalues for constrained axes:
##    RDA1    RDA2    RDA3    RDA4    RDA5    RDA6 
## 0.10104 0.04470 0.01707 0.01509 0.01381 0.00505 
## 
## Eigenvalues for unconstrained axes:
##     PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8 
## 0.06484 0.02672 0.01664 0.01514 0.01038 0.00852 0.00660 0.00458 
## (Showing 8 of 17 unconstrained eigenvalues)
```

---

# Enfoques automáticos &lt;br&gt;de selección de modelos

- Define el mejor modelo con todas las posibles variables importantes (Modelo Full)

- Utiliza el método de selección corregido para RDA-CCA (usando `\(R^2\)` Ajustado)


```r
# Revisar r cuadrado ajustado pero solo de un modelo
RsquareAdj(Modelo_Full)

# Selección paso a paso ajustada por r cuadrado ajustado
ordiR2step(Modelo_Nulo, Modelo_Full, trace=FALSE)
```

---


```r
permustats(anova(RDA_vare)) |&gt; summary()
```

```
## 
##       statistic    SES   mean lower median  upper Pr(perm)    
## Model    3.3201 7.6986 1.0337       0.9927 1.5882    0.001 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Interval (Upper - Lower) = 0.95)
```

---


```r
permustats(anova(RDA_vare)) |&gt; densityplot()
```

&lt;img src="index_files/figure-html/unnamed-chunk-33-1.png" width="90%" /&gt;

---


```r
permustats(anova(RDA_vare, by="axis")) |&gt; summary()
```

```
## 
##      statistic     SES    mean lower  median   upper Pr(perm)    
## RDA1   10.2293  5.9564  3.1164        2.9010  5.3902    0.001 ***
## RDA2    4.5257  2.4354  2.3981        2.2512  4.0340    0.026 *  
## RDA3    1.7278 -0.3790  1.9945        1.8536  3.3135    0.588    
## RDA4    1.5279 -0.3411  1.7589        1.6172  3.0974    0.565    
## RDA5    1.3985 -0.0381  1.4227        1.3001  2.6939    0.436    
## RDA6    0.5112 -0.8799  1.0024        0.8886  2.1184    0.840    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Interval (Upper - Lower) = 0.95)
```

---


```r
permustats(anova(RDA_vare, by="axis")) |&gt; densityplot()
```

&lt;img src="index_files/figure-html/unnamed-chunk-35-1.png" width="90%" /&gt;

---
 

```r
permustats(anova(RDA_vare, by="terms")) |&gt; summary()
```

```
## 
##            statistic     SES    mean lower  median   upper Pr(perm)    
## Al            7.5980 10.3327  1.0235        0.8457  2.2821    0.001 ***
## P             3.6535  3.9092  1.0650        0.8692  2.3554    0.004 ** 
## K             2.3019  2.3279  1.0094        0.9160  2.0225    0.026 *  
## Baresoil      1.5761  0.8768  1.0137        0.8355  2.3487    0.144    
## P:K           2.2824  2.1308  1.0153        0.8438  2.1936    0.046 *  
## P:Baresoil    2.5084  2.6540  1.0007        0.8574  2.1265    0.023 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Interval (Upper - Lower) = 0.95)
```

---


```r
permustats(anova(RDA_vare, by="terms")) |&gt; densityplot()
```

&lt;img src="index_files/figure-html/unnamed-chunk-37-1.png" width="90%" /&gt;

---
class: middle, center

# Gracias por su atención
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="assets/remark-0.14.0.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "atom-one-light",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(https://raw.githubusercontent.com/irwingss/IrwingRLab/master/escudo.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  bottom: 1em;
  left: 4em;
  width: 25px;
  height: 25px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
