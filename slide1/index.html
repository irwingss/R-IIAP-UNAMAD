<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Análisis Multivariados en R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Irwing S. Saldaña" />
    <meta name="author" content="Departamento de Ecoinformática y Biogeografía" />
    <meta name="author" content="Instituto de Ciencias Antonio Brack" />
    <meta name="date" content="2021-01-01" />
    <script src="assets/header-attrs/header-attrs.js"></script>
    <link href="assets/tile-view/tile-view.css" rel="stylesheet" />
    <script src="assets/tile-view/tile-view.js"></script>
    <script src="assets/xaringanExtra_fit-screen/fit-screen.js"></script>
    <script src="assets/clipboard/clipboard.min.js"></script>
    <link href="assets/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="assets/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script type="application/json" id="xaringanExtra-editable-docid">{"id":"xb2ad395908a4e3094fa35f707bc20e6","expires":1}</script>
    <script src="assets/himalaya/himalaya.js"></script>
    <script src="assets/js-cookie/js.cookie.js"></script>
    <link href="assets/editable/editable.css" rel="stylesheet" />
    <script src="assets/editable/editable.js"></script>
    <script src="assets/fabric/fabric.min.js"></script>
    <link href="assets/xaringanExtra-scribble/scribble.css" rel="stylesheet" />
    <script src="assets/xaringanExtra-scribble/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30,"palette":[]}) })</script>
    <link href="assets/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link href="assets/countdown/countdown.css" rel="stylesheet" />
    <script src="assets/countdown/countdown.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: title-slide

&lt;br&gt;
&lt;br&gt;
# &lt;span style = 'font-size: 100%;color:#5f00db;'&gt;Análisis Multivariados en R&lt;/span&gt;
## &lt;span style = 'font-size: 90%;color:#212121;'&gt;Curso Colaborativo IIAP - UNAMAD&lt;/span&gt;
### &lt;span style = 'font-size: 85%;color:#212121;'&gt;Irwing S. Saldaña&lt;/span&gt;
### &lt;span style = 'font-size: 80%;color:#212121;'&gt;&lt;br&gt;[Instituto de Ciencias Antonio Brack](https://www.brackinstitute.com/)&lt;br&gt;Departamento de Ecoinformática y Biogeografía&lt;br&gt;Perú, 2021&lt;/span&gt;



&lt;style type="text/css"&gt;
/* Footnote */
.remark-slide-content:after {
    content: "Blgo. Irwing S. Saldaña | Instituto de Ciencias Antonio Brack, Perú";
    opacity: 0.9;
    position: absolute;
    text-align: left;
    height: 20px;
    font-size: 12pt;
    left: 120px;
    bottom: 18px;
    font-family: 'Yanone Kaffeesatz';
    font-weight: normal;
    width: 1200px;
}
&lt;/style&gt;

---
class: inverse, middle, center 
background-image: url(figs/fondo.jpg)
background-size: cover
background-position: top

&lt;img src="figs/aboutme.png" width="25%" style="display: block; margin: auto;" /&gt;

### Blgo. Irwing S. Saldaña &lt;br&gt;&lt;span style= 'font-size:80%; font-weigth: light;'&gt; Instructor&lt;/span&gt;
&lt;span style= 'font-family: calibri; color: white'&gt;,&lt;br&gt;
Instituto de Ciencias Antonio Brack, Perú&lt;/span&gt;

.white[[Website](https://www.brackinstitute.com/)|[ResearchGate](https://www.researchgate.net/profile/Irwing-Saldana)|[Linkedin](https://www.linkedin.com/in/irssald/)|[R Latam Blog](https://rlatam.blog/) ]

---
class: inverse, middle, center , animated, slideInRight

# Necesidad de representar el mundo &lt;br&gt;en N-dimensiones
[ Paradoja de Simpson ]

---

# Paradoja de Simpson

Para comprender la importancia de los análisis multivariados comencemos revisando esta base de datos.


```r
library(tidyverse)
library(palmerpenguins)
pinguinos&lt;-na.omit(penguins)
```

<div id="qouwplhbop" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qouwplhbop .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qouwplhbop .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qouwplhbop .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qouwplhbop .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qouwplhbop .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qouwplhbop .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qouwplhbop .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qouwplhbop .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qouwplhbop .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qouwplhbop .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qouwplhbop .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qouwplhbop .gt_from_md > :first-child {
  margin-top: 0;
}

#qouwplhbop .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qouwplhbop .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qouwplhbop .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qouwplhbop .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qouwplhbop .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qouwplhbop .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qouwplhbop .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qouwplhbop .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qouwplhbop .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qouwplhbop .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qouwplhbop .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qouwplhbop .gt_left {
  text-align: left;
}

#qouwplhbop .gt_center {
  text-align: center;
}

#qouwplhbop .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qouwplhbop .gt_font_normal {
  font-weight: normal;
}

#qouwplhbop .gt_font_bold {
  font-weight: bold;
}

#qouwplhbop .gt_font_italic {
  font-style: italic;
}

#qouwplhbop .gt_super {
  font-size: 65%;
}

#qouwplhbop .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">species</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">bill_length_mm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">bill_depth_mm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">flipper_length_mm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">39.1</td>
<td class="gt_row gt_right">18.7</td>
<td class="gt_row gt_right">181</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_center">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">39.5</td>
<td class="gt_row gt_right">17.4</td>
<td class="gt_row gt_right">186</td>
<td class="gt_row gt_right">3800</td>
<td class="gt_row gt_center">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">40.3</td>
<td class="gt_row gt_right">18.0</td>
<td class="gt_row gt_right">195</td>
<td class="gt_row gt_right">3250</td>
<td class="gt_row gt_center">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">36.7</td>
<td class="gt_row gt_right">19.3</td>
<td class="gt_row gt_right">193</td>
<td class="gt_row gt_right">3450</td>
<td class="gt_row gt_center">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">39.3</td>
<td class="gt_row gt_right">20.6</td>
<td class="gt_row gt_right">190</td>
<td class="gt_row gt_right">3650</td>
<td class="gt_row gt_center">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_center">Torgersen</td>
<td class="gt_row gt_right">38.9</td>
<td class="gt_row gt_right">17.8</td>
<td class="gt_row gt_right">181</td>
<td class="gt_row gt_right">3625</td>
<td class="gt_row gt_center">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>

---
# Paradoja de Simpson


```r
# Gráfico con ggplot2
library(tidyverse)
pinguinos %&gt;%
  ggplot(aes(x=bill_length_mm, 
             y=bill_depth_mm)) +
  geom_point() + 
  labs(x="Longitud Pico (mm)", 
       y="Profundidad Pico (mm)",
       title="Longitud de pico en función de su profundidad") +
  theme_bw()
```

---
# Paradoja de Simpson

&lt;img src="index_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---
# Paradoja de Simpson


```r
# Gráfico con ggplot2
library(tidyverse)
pinguinos %&gt;%
  ggplot(aes(x=bill_length_mm, 
             y=bill_depth_mm)) +
  geom_point() + 
* geom_smooth(method="lm")+
  labs(x="Longitud Pico (mm)", 
       y="Profundidad Pico (mm)",
       title="Longitud de pico en función de su profundidad") +
  theme_bw()
```

---
# Paradoja de Simpson

&lt;img src="index_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---
# Paradoja de Simpson


```r
# Gráfico con ggplot2
library(tidyverse)
pinguinos %&gt;%
  ggplot(aes(x=bill_length_mm, 
             y=bill_depth_mm,
             `color=species`,
             `fill=species`)) +
  geom_point() + 
  geom_smooth(method="lm")+ 
  labs(x="Longitud Pico (mm)", 
       y="Profundidad Pico (mm)",
       title="Longitud de pico en función de su profundidad") +
  theme_bw()
```

---
# Paradoja de Simpson

&lt;img src="index_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---
class: inverse, middle, center , animated, slideInRight

# Introducción a la Estadística Multivariada
[ Ordenamientos - Agrupamientos ]

---

# El Mundo es Multivariado

--

- Implica técnicas que involucran tres o más variables a la vez.

--

- Típicamente no se incluyen como _análisis multivariados_ del tipo regresión múltiple, MANOVA.

--

<div id="qouwplhbop" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qouwplhbop .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qouwplhbop .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qouwplhbop .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qouwplhbop .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qouwplhbop .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qouwplhbop .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qouwplhbop .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qouwplhbop .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qouwplhbop .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qouwplhbop .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qouwplhbop .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qouwplhbop .gt_from_md > :first-child {
  margin-top: 0;
}

#qouwplhbop .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qouwplhbop .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qouwplhbop .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qouwplhbop .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qouwplhbop .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qouwplhbop .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qouwplhbop .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qouwplhbop .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qouwplhbop .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qouwplhbop .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qouwplhbop .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qouwplhbop .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qouwplhbop .gt_left {
  text-align: left;
}

#qouwplhbop .gt_center {
  text-align: center;
}

#qouwplhbop .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qouwplhbop .gt_font_normal {
  font-weight: normal;
}

#qouwplhbop .gt_font_bold {
  font-weight: bold;
}

#qouwplhbop .gt_font_italic {
  font-style: italic;
}

#qouwplhbop .gt_super {
  font-size: 65%;
}

#qouwplhbop .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Métodos interdependientes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Métodos dependientes</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Conocido como ordenamiento sin restricciones</td>
<td class="gt_row gt_left">Conocido como ordenamiento con restricciones (Canónico)</td></tr>
    <tr><td class="gt_row gt_left">1 grupo de variables</td>
<td class="gt_row gt_left">2 grupos de variables : X e</td></tr>
    <tr><td class="gt_row gt_left">Permiten describir</td>
<td class="gt_row gt_left">Permiten predecir</td></tr>
    <tr><td class="gt_row gt_left">No buscan definir la relación entre variables dependientes o independientes</td>
<td class="gt_row gt_left">Buscan definir la relación entre variables dependientes o independientes</td></tr>
    <tr><td class="gt_row gt_left">Busca observar patrones de agrupamiento en los datos</td>
<td class="gt_row gt_left">Busca definir la causa de los patrones de agrupamiento</td></tr>
    <tr><td class="gt_row gt_left">No hay contraste de hipótesis.</td>
<td class="gt_row gt_left">Hay contraste de hipótesis</td></tr>
    <tr><td class="gt_row gt_left">Veremos: Clustering, CA, PCA, MDS, NMDS</td>
<td class="gt_row gt_left">Veremos: RDA, CCA</td></tr>
  </tbody>
  
  
</table>
</div>
---

# Bases de datos en Análisis Multivariados

<div id="wbjaahshwa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wbjaahshwa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wbjaahshwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wbjaahshwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wbjaahshwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbjaahshwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wbjaahshwa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wbjaahshwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wbjaahshwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wbjaahshwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wbjaahshwa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wbjaahshwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wbjaahshwa .gt_from_md > :first-child {
  margin-top: 0;
}

#wbjaahshwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wbjaahshwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wbjaahshwa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#wbjaahshwa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbjaahshwa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#wbjaahshwa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbjaahshwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wbjaahshwa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wbjaahshwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbjaahshwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#wbjaahshwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#wbjaahshwa .gt_left {
  text-align: left;
}

#wbjaahshwa .gt_center {
  text-align: center;
}

#wbjaahshwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wbjaahshwa .gt_font_normal {
  font-weight: normal;
}

#wbjaahshwa .gt_font_bold {
  font-weight: bold;
}

#wbjaahshwa .gt_font_italic {
  font-style: italic;
}

#wbjaahshwa .gt_super {
  font-size: 65%;
}

#wbjaahshwa .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Sitio</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">E</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Profundidad</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Polucion</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Temp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Sedimento</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">s1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">72</td>
<td class="gt_row gt_right">4.8</td>
<td class="gt_row gt_right">3.5</td>
<td class="gt_row gt_left">S</td></tr>
    <tr><td class="gt_row gt_left">s2</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">11</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">75</td>
<td class="gt_row gt_right">2.8</td>
<td class="gt_row gt_right">2.5</td>
<td class="gt_row gt_left">C</td></tr>
    <tr><td class="gt_row gt_left">s3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">59</td>
<td class="gt_row gt_right">5.4</td>
<td class="gt_row gt_right">2.7</td>
<td class="gt_row gt_left">C</td></tr>
    <tr><td class="gt_row gt_left">s4</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">15</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">64</td>
<td class="gt_row gt_right">8.2</td>
<td class="gt_row gt_right">2.9</td>
<td class="gt_row gt_left">S</td></tr>
    <tr><td class="gt_row gt_left">s5</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">61</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">3.1</td>
<td class="gt_row gt_left">C</td></tr>
    <tr><td class="gt_row gt_left">s6</td>
<td class="gt_row gt_right">31</td>
<td class="gt_row gt_right">21</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">16</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">94</td>
<td class="gt_row gt_right">2.6</td>
<td class="gt_row gt_right">3.5</td>
<td class="gt_row gt_left">G</td></tr>
    <tr><td class="gt_row gt_left">s7</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">11</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">53</td>
<td class="gt_row gt_right">4.6</td>
<td class="gt_row gt_right">2.9</td>
<td class="gt_row gt_left">S</td></tr>
    <tr><td class="gt_row gt_left">s8</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">61</td>
<td class="gt_row gt_right">5.1</td>
<td class="gt_row gt_right">3.3</td>
<td class="gt_row gt_left">C</td></tr>
  </tbody>
  
  
</table>
</div>

---
# ¿Qué es ordenamiento?

- Los métodos de ordenamientos "ordenan" las observaciones "filas" (que pueden representar individuos, sitios, parcelas, etc.), usando la información de múltiples variables "columnas".

- Se utilizan técnicas matemáticas de reducción de dimensiones para lograr proyectar toda (o la mayor parte) la información de una base de datos en tan solo 2 dimensiones (gráficos en plano cartesiano).

.pull-left[
&lt;img src="figs/TABLE.jpg" width="50%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="figs/Reduccion.webp" width="70%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse, middle, center , animated, slideInRight

# Buscando relaciones entre variables
[ Variables y la manera de investigar sus relaciones ]

---

# Variables

- **Categóricas (Factores):**
  - *Binarias* (0,1; presencia-ausencia)
  - *Ordinal* (Alto &gt; Medio &gt; Bajo, mes de muestreo,)
  - *Nominal* (Sitio A, Sitio B, Sitio C)
  
- **Numéricas:**
  - *Discretas* (Abundancias-Conteos: 1,2,3,4,5)
  - *Continuas* (Mediciones: 1.96, 4.56, 3.75)
      - *Ratio* (Cero es absoluto, no negativos. Biomasa, concentraciones, longitudes, pesos)
      - *Intervalo* (Cero no es absoluto. Variables asociadas al tiempo)
      - *Porcentajes* (son especiales, restringidas al rango 0-1)

---

# Análisis Exploratorio Básico

También conocido como exploratory data analysis (EDA). Permite:
- Encontrar patrones en los datos.
- Sugerir estrategias de modelamiento.
- Corregir algún error en la base de datos.

1. **Univariado** 
  - Gráficos de barras.
  - Gráfico de densidad.
  - Histograma de frecuencias.
  - Cuantiles o  gráfico de boxplot.
  
2. **Bivariado** 

  - Variables .red[numérica vs numérica]: dispersión de puntos, densidad 2D.
  - Variables .red[numérica vs categórica]: boxplot.
  - Variables .red[categórica vs categórica]: gráfico de barras.

---

# Análisis Exploratorio Básico


```r
# Carga el archivo "variables ambientales.xlsx"
ambiente &lt;- openxlsx::read.xlsx(file.choose())

# Activa la librería GGally
library(GGally)

# Gráfico
ggpairs(ambiente,
        upper= list(continuous= wrap("cor", method="spearman",
                                     color="#5f00db", size=3.5)),
        lower= list(continuous= wrap("points", 
                                       color="#5f00db", alpha=0.5)),
        diag= list(continuous= wrap("densityDiag", 
                                      fill="#5f00db", alpha=0.5)))+
  theme_test()
```

---

# Análisis Exploratorio Básico

&lt;img src="figs/ggpairs.png" width="80%" style="display: block; margin: auto;" /&gt;

]
]

---
# Libro R for Data Science (Wickham &amp; Grolemund, 2017)

[Visita aquí el libro Web, capítulo: Análisis Exploratorio de Datos](https://es.r4ds.hadley.nz/an%C3%A1lisis-exploratorio-de-datos-eda.html)

---

Greenacre &amp; Primicerio (2014) propusieron la división de los Análisis Multivariados aplicados a las ciencias ecológicas en:  

--

- **Métodos Estructurales:** buscan la estructura de la base de datos.
- **Métodos Funcionales:** buscan explicar y. 
- **Métodos Híbridos:** mezclan características de los  anteriores.

&lt;img src="figs/Four corners.png" width="80%" style="display: block; margin: auto;" /&gt;

---

La estructura de las matrices de datos está relacionada con el tipo de análisis que se desea realizar 
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="figs/matrices.jpg" alt="&amp;lt;span style = 'font-size: 70%; color: #59c2ff;'&amp;gt;Greenacre, M., &amp;amp; Primicerio, R. (2014). Multivariate analysis of ecological data. Fundacion BBVA.&amp;lt;/span&amp;gt;" width="80%" /&gt;
&lt;p class="caption"&gt;&lt;span style = 'font-size: 70%; color: #59c2ff;'&gt;Greenacre, M., &amp; Primicerio, R. (2014). Multivariate analysis of ecological data. Fundacion BBVA.&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;

---
# Transformaciones

.pull-left[
1) Logaritmo `log()`
- Si `\(x \to 0\)`, entonces `\(\log(x) \to -\infty\)`
- Si `\(x = 0\)`, entonces `\(\log(x=1) = 0\)`
- Si `\(x \to \infty\)`, entonces `\(\log(x) \to \infty\)`
- Además: `\(\log(ab) = log(a)+log(b)\)`

2) Transformación de Box-Cox-Chord

$$
g\left(y\right)=\begin{cases}
\frac{y^{\lambda}-1}{\lambda} &amp; \lambda\ne0\\
     \log y &amp; \lambda=0
\end{cases}
$$

3) Raíz cuadrada `sqrt()`
]

.pull-right[
4) Transformación de Hellinger ( `\(y_{i+}\)` es `\(j = 1, \dots, m\)`)

`$$y_{ij}^{\prime} = \sqrt{\frac{y_{ij}}{y_{i+}}}$$`
5) Transformación de Chi-cuadrado
`$$\chi^2_{x,y} = \sqrt{\sum_{j=1}^{J} \frac1{C_{j}}(x_j-y_j)^2}$$`

6) Estandarización (Centrado y Escalado) `scale()`
]

---

class: inverse, middle, center , animated, slideInRight

# Midiendo Distancias 
[ La base de los análisis multivariados es hacerlo bien ]

---

# Matrices de Biodiversidad

Antes de ver las matrices de distancias, veamos una matriz de biodiversidad (abundancias,  presencia-ausencia):


```r
library(vegan)
data("mite")
View(mite)
```

<div id="qcbkajszao" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qcbkajszao .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qcbkajszao .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qcbkajszao .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qcbkajszao .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qcbkajszao .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qcbkajszao .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qcbkajszao .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qcbkajszao .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qcbkajszao .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qcbkajszao .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qcbkajszao .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qcbkajszao .gt_from_md > :first-child {
  margin-top: 0;
}

#qcbkajszao .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qcbkajszao .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qcbkajszao .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qcbkajszao .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qcbkajszao .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qcbkajszao .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qcbkajszao .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qcbkajszao .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qcbkajszao .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qcbkajszao .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qcbkajszao .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qcbkajszao .gt_left {
  text-align: left;
}

#qcbkajszao .gt_center {
  text-align: center;
}

#qcbkajszao .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qcbkajszao .gt_font_normal {
  font-weight: normal;
}

#qcbkajszao .gt_font_bold {
  font-weight: bold;
}

#qcbkajszao .gt_font_italic {
  font-style: italic;
}

#qcbkajszao .gt_super {
  font-size: 65%;
}

#qcbkajszao .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Brachy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PHTH</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HPAV</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">RARD</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SSTR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Protopl</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">MEGR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">MPRO</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">TVIE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HMIN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HMIN2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">NPRA</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">TVEL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ONOV</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SUCT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">LCIL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Oribatl1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Ceratoz1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PWIL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Galumna1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Stgncrs2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HRUF</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Trhypch1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PPEL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">NCOR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SLAT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">FSET</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Lepidzts</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Eupelops</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Miniglmn</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">LRUG</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PLAG2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Ceratoz3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Oppiminu</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Trimalc2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">17</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">17</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">50</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">16</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">21</td>
<td class="gt_row gt_right">27</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">138</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">17</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">89</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">23</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">18</td>
<td class="gt_row gt_right">47</td>
<td class="gt_row gt_right">17</td>
<td class="gt_row gt_right">108</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">32</td>
<td class="gt_row gt_right">43</td>
<td class="gt_row gt_right">27</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_right">19</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">16</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">38</td>
<td class="gt_row gt_right">39</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>

---
# Matrices de Distancias

Los métodos multivariados buscan generar agrupaciones o clasificaciones de las observaciones (filas), basándose en sus distancias.


```r
matriz &lt;- vegan::vegdist(mite, method = "bray") 
```

<div id="qcbkajszao" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qcbkajszao .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qcbkajszao .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qcbkajszao .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qcbkajszao .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qcbkajszao .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qcbkajszao .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qcbkajszao .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qcbkajszao .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qcbkajszao .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qcbkajszao .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qcbkajszao .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qcbkajszao .gt_from_md > :first-child {
  margin-top: 0;
}

#qcbkajszao .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qcbkajszao .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qcbkajszao .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qcbkajszao .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qcbkajszao .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qcbkajszao .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qcbkajszao .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qcbkajszao .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qcbkajszao .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qcbkajszao .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qcbkajszao .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qcbkajszao .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qcbkajszao .gt_left {
  text-align: left;
}

#qcbkajszao .gt_center {
  text-align: center;
}

#qcbkajszao .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qcbkajszao .gt_font_normal {
  font-weight: normal;
}

#qcbkajszao .gt_font_bold {
  font-weight: bold;
}

#qcbkajszao .gt_font_italic {
  font-style: italic;
}

#qcbkajszao .gt_super {
  font-size: 65%;
}

#qcbkajszao .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">7</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">8</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">9</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">10</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">11</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">12</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">13</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">14</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">15</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">16</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">17</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">18</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">19</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">20</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">21</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">22</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">23</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">24</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">25</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">26</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">27</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">28</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">29</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">30</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">31</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">32</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">33</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">34</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">35</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">36</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">37</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">38</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">39</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">40</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">41</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">42</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">43</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">44</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">45</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">46</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">47</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">48</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">49</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">50</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">51</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">52</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">53</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">54</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">55</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">56</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">57</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">58</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">59</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">60</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">61</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">62</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">63</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">64</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">65</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">66</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">67</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">68</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">69</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">70</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.466</td>
<td class="gt_row gt_right">0.362</td>
<td class="gt_row gt_right">0.408</td>
<td class="gt_row gt_right">0.622</td>
<td class="gt_row gt_right">0.564</td>
<td class="gt_row gt_right">0.536</td>
<td class="gt_row gt_right">0.571</td>
<td class="gt_row gt_right">0.354</td>
<td class="gt_row gt_right">0.516</td>
<td class="gt_row gt_right">0.567</td>
<td class="gt_row gt_right">0.603</td>
<td class="gt_row gt_right">0.691</td>
<td class="gt_row gt_right">0.619</td>
<td class="gt_row gt_right">0.350</td>
<td class="gt_row gt_right">0.527</td>
<td class="gt_row gt_right">0.574</td>
<td class="gt_row gt_right">0.535</td>
<td class="gt_row gt_right">0.519</td>
<td class="gt_row gt_right">0.642</td>
<td class="gt_row gt_right">0.634</td>
<td class="gt_row gt_right">0.686</td>
<td class="gt_row gt_right">0.484</td>
<td class="gt_row gt_right">0.564</td>
<td class="gt_row gt_right">0.536</td>
<td class="gt_row gt_right">0.562</td>
<td class="gt_row gt_right">0.636</td>
<td class="gt_row gt_right">0.594</td>
<td class="gt_row gt_right">0.570</td>
<td class="gt_row gt_right">0.432</td>
<td class="gt_row gt_right">0.319</td>
<td class="gt_row gt_right">0.665</td>
<td class="gt_row gt_right">0.565</td>
<td class="gt_row gt_right">0.647</td>
<td class="gt_row gt_right">0.777</td>
<td class="gt_row gt_right">0.568</td>
<td class="gt_row gt_right">0.735</td>
<td class="gt_row gt_right">0.532</td>
<td class="gt_row gt_right">0.487</td>
<td class="gt_row gt_right">0.515</td>
<td class="gt_row gt_right">0.475</td>
<td class="gt_row gt_right">0.514</td>
<td class="gt_row gt_right">0.514</td>
<td class="gt_row gt_right">0.700</td>
<td class="gt_row gt_right">0.456</td>
<td class="gt_row gt_right">0.531</td>
<td class="gt_row gt_right">0.778</td>
<td class="gt_row gt_right">0.534</td>
<td class="gt_row gt_right">0.700</td>
<td class="gt_row gt_right">0.472</td>
<td class="gt_row gt_right">0.541</td>
<td class="gt_row gt_right">0.500</td>
<td class="gt_row gt_right">0.516</td>
<td class="gt_row gt_right">0.672</td>
<td class="gt_row gt_right">0.687</td>
<td class="gt_row gt_right">0.476</td>
<td class="gt_row gt_right">0.959</td>
<td class="gt_row gt_right">0.686</td>
<td class="gt_row gt_right">0.530</td>
<td class="gt_row gt_right">0.453</td>
<td class="gt_row gt_right">0.780</td>
<td class="gt_row gt_right">0.856</td>
<td class="gt_row gt_right">0.522</td>
<td class="gt_row gt_right">0.649</td>
<td class="gt_row gt_right">0.683</td>
<td class="gt_row gt_right">0.727</td>
<td class="gt_row gt_right">0.876</td>
<td class="gt_row gt_right">0.514</td>
<td class="gt_row gt_right">0.673</td>
<td class="gt_row gt_right">0.617</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0.466</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.256</td>
<td class="gt_row gt_right">0.245</td>
<td class="gt_row gt_right">0.572</td>
<td class="gt_row gt_right">0.593</td>
<td class="gt_row gt_right">0.581</td>
<td class="gt_row gt_right">0.563</td>
<td class="gt_row gt_right">0.514</td>
<td class="gt_row gt_right">0.604</td>
<td class="gt_row gt_right">0.591</td>
<td class="gt_row gt_right">0.622</td>
<td class="gt_row gt_right">0.663</td>
<td class="gt_row gt_right">0.609</td>
<td class="gt_row gt_right">0.533</td>
<td class="gt_row gt_right">0.671</td>
<td class="gt_row gt_right">0.693</td>
<td class="gt_row gt_right">0.611</td>
<td class="gt_row gt_right">0.642</td>
<td class="gt_row gt_right">0.580</td>
<td class="gt_row gt_right">0.662</td>
<td class="gt_row gt_right">0.673</td>
<td class="gt_row gt_right">0.742</td>
<td class="gt_row gt_right">0.655</td>
<td class="gt_row gt_right">0.668</td>
<td class="gt_row gt_right">0.577</td>
<td class="gt_row gt_right">0.619</td>
<td class="gt_row gt_right">0.704</td>
<td class="gt_row gt_right">0.710</td>
<td class="gt_row gt_right">0.681</td>
<td class="gt_row gt_right">0.538</td>
<td class="gt_row gt_right">0.695</td>
<td class="gt_row gt_right">0.663</td>
<td class="gt_row gt_right">0.593</td>
<td class="gt_row gt_right">0.726</td>
<td class="gt_row gt_right">0.656</td>
<td class="gt_row gt_right">0.715</td>
<td class="gt_row gt_right">0.396</td>
<td class="gt_row gt_right">0.624</td>
<td class="gt_row gt_right">0.520</td>
<td class="gt_row gt_right">0.628</td>
<td class="gt_row gt_right">0.510</td>
<td class="gt_row gt_right">0.471</td>
<td class="gt_row gt_right">0.811</td>
<td class="gt_row gt_right">0.620</td>
<td class="gt_row gt_right">0.578</td>
<td class="gt_row gt_right">0.748</td>
<td class="gt_row gt_right">0.633</td>
<td class="gt_row gt_right">0.749</td>
<td class="gt_row gt_right">0.543</td>
<td class="gt_row gt_right">0.710</td>
<td class="gt_row gt_right">0.668</td>
<td class="gt_row gt_right">0.608</td>
<td class="gt_row gt_right">0.798</td>
<td class="gt_row gt_right">0.798</td>
<td class="gt_row gt_right">0.580</td>
<td class="gt_row gt_right">0.978</td>
<td class="gt_row gt_right">0.717</td>
<td class="gt_row gt_right">0.682</td>
<td class="gt_row gt_right">0.559</td>
<td class="gt_row gt_right">0.877</td>
<td class="gt_row gt_right">0.943</td>
<td class="gt_row gt_right">0.734</td>
<td class="gt_row gt_right">0.713</td>
<td class="gt_row gt_right">0.721</td>
<td class="gt_row gt_right">0.724</td>
<td class="gt_row gt_right">0.725</td>
<td class="gt_row gt_right">0.615</td>
<td class="gt_row gt_right">0.695</td>
<td class="gt_row gt_right">0.666</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0.362</td>
<td class="gt_row gt_right">0.256</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.271</td>
<td class="gt_row gt_right">0.564</td>
<td class="gt_row gt_right">0.544</td>
<td class="gt_row gt_right">0.546</td>
<td class="gt_row gt_right">0.526</td>
<td class="gt_row gt_right">0.411</td>
<td class="gt_row gt_right">0.580</td>
<td class="gt_row gt_right">0.587</td>
<td class="gt_row gt_right">0.649</td>
<td class="gt_row gt_right">0.686</td>
<td class="gt_row gt_right">0.631</td>
<td class="gt_row gt_right">0.448</td>
<td class="gt_row gt_right">0.597</td>
<td class="gt_row gt_right">0.594</td>
<td class="gt_row gt_right">0.605</td>
<td class="gt_row gt_right">0.599</td>
<td class="gt_row gt_right">0.589</td>
<td class="gt_row gt_right">0.624</td>
<td class="gt_row gt_right">0.670</td>
<td class="gt_row gt_right">0.708</td>
<td class="gt_row gt_right">0.556</td>
<td class="gt_row gt_right">0.670</td>
<td class="gt_row gt_right">0.536</td>
<td class="gt_row gt_right">0.577</td>
<td class="gt_row gt_right">0.650</td>
<td class="gt_row gt_right">0.663</td>
<td class="gt_row gt_right">0.596</td>
<td class="gt_row gt_right">0.443</td>
<td class="gt_row gt_right">0.634</td>
<td class="gt_row gt_right">0.652</td>
<td class="gt_row gt_right">0.626</td>
<td class="gt_row gt_right">0.737</td>
<td class="gt_row gt_right">0.567</td>
<td class="gt_row gt_right">0.705</td>
<td class="gt_row gt_right">0.387</td>
<td class="gt_row gt_right">0.514</td>
<td class="gt_row gt_right">0.493</td>
<td class="gt_row gt_right">0.581</td>
<td class="gt_row gt_right">0.454</td>
<td class="gt_row gt_right">0.329</td>
<td class="gt_row gt_right">0.748</td>
<td class="gt_row gt_right">0.552</td>
<td class="gt_row gt_right">0.524</td>
<td class="gt_row gt_right">0.759</td>
<td class="gt_row gt_right">0.538</td>
<td class="gt_row gt_right">0.768</td>
<td class="gt_row gt_right">0.515</td>
<td class="gt_row gt_right">0.653</td>
<td class="gt_row gt_right">0.577</td>
<td class="gt_row gt_right">0.589</td>
<td class="gt_row gt_right">0.779</td>
<td class="gt_row gt_right">0.746</td>
<td class="gt_row gt_right">0.551</td>
<td class="gt_row gt_right">0.969</td>
<td class="gt_row gt_right">0.720</td>
<td class="gt_row gt_right">0.572</td>
<td class="gt_row gt_right">0.546</td>
<td class="gt_row gt_right">0.886</td>
<td class="gt_row gt_right">0.950</td>
<td class="gt_row gt_right">0.662</td>
<td class="gt_row gt_right">0.715</td>
<td class="gt_row gt_right">0.685</td>
<td class="gt_row gt_right">0.735</td>
<td class="gt_row gt_right">0.799</td>
<td class="gt_row gt_right">0.596</td>
<td class="gt_row gt_right">0.686</td>
<td class="gt_row gt_right">0.629</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0.408</td>
<td class="gt_row gt_right">0.245</td>
<td class="gt_row gt_right">0.271</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.443</td>
<td class="gt_row gt_right">0.426</td>
<td class="gt_row gt_right">0.473</td>
<td class="gt_row gt_right">0.524</td>
<td class="gt_row gt_right">0.511</td>
<td class="gt_row gt_right">0.429</td>
<td class="gt_row gt_right">0.522</td>
<td class="gt_row gt_right">0.511</td>
<td class="gt_row gt_right">0.551</td>
<td class="gt_row gt_right">0.416</td>
<td class="gt_row gt_right">0.534</td>
<td class="gt_row gt_right">0.645</td>
<td class="gt_row gt_right">0.654</td>
<td class="gt_row gt_right">0.480</td>
<td class="gt_row gt_right">0.574</td>
<td class="gt_row gt_right">0.485</td>
<td class="gt_row gt_right">0.613</td>
<td class="gt_row gt_right">0.563</td>
<td class="gt_row gt_right">0.624</td>
<td class="gt_row gt_right">0.623</td>
<td class="gt_row gt_right">0.643</td>
<td class="gt_row gt_right">0.562</td>
<td class="gt_row gt_right">0.499</td>
<td class="gt_row gt_right">0.662</td>
<td class="gt_row gt_right">0.612</td>
<td class="gt_row gt_right">0.613</td>
<td class="gt_row gt_right">0.476</td>
<td class="gt_row gt_right">0.625</td>
<td class="gt_row gt_right">0.602</td>
<td class="gt_row gt_right">0.546</td>
<td class="gt_row gt_right">0.698</td>
<td class="gt_row gt_right">0.628</td>
<td class="gt_row gt_right">0.685</td>
<td class="gt_row gt_right">0.394</td>
<td class="gt_row gt_right">0.647</td>
<td class="gt_row gt_right">0.567</td>
<td class="gt_row gt_right">0.651</td>
<td class="gt_row gt_right">0.535</td>
<td class="gt_row gt_right">0.470</td>
<td class="gt_row gt_right">0.815</td>
<td class="gt_row gt_right">0.586</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.725</td>
<td class="gt_row gt_right">0.639</td>
<td class="gt_row gt_right">0.720</td>
<td class="gt_row gt_right">0.576</td>
<td class="gt_row gt_right">0.724</td>
<td class="gt_row gt_right">0.658</td>
<td class="gt_row gt_right">0.633</td>
<td class="gt_row gt_right">0.809</td>
<td class="gt_row gt_right">0.826</td>
<td class="gt_row gt_right">0.624</td>
<td class="gt_row gt_right">0.973</td>
<td class="gt_row gt_right">0.730</td>
<td class="gt_row gt_right">0.686</td>
<td class="gt_row gt_right">0.603</td>
<td class="gt_row gt_right">0.854</td>
<td class="gt_row gt_right">0.926</td>
<td class="gt_row gt_right">0.656</td>
<td class="gt_row gt_right">0.754</td>
<td class="gt_row gt_right">0.724</td>
<td class="gt_row gt_right">0.706</td>
<td class="gt_row gt_right">0.781</td>
<td class="gt_row gt_right">0.647</td>
<td class="gt_row gt_right">0.540</td>
<td class="gt_row gt_right">0.656</td></tr>
    <tr><td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">0.622</td>
<td class="gt_row gt_right">0.572</td>
<td class="gt_row gt_right">0.564</td>
<td class="gt_row gt_right">0.443</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.299</td>
<td class="gt_row gt_right">0.380</td>
<td class="gt_row gt_right">0.354</td>
<td class="gt_row gt_right">0.547</td>
<td class="gt_row gt_right">0.353</td>
<td class="gt_row gt_right">0.393</td>
<td class="gt_row gt_right">0.359</td>
<td class="gt_row gt_right">0.420</td>
<td class="gt_row gt_right">0.389</td>
<td class="gt_row gt_right">0.599</td>
<td class="gt_row gt_right">0.480</td>
<td class="gt_row gt_right">0.453</td>
<td class="gt_row gt_right">0.445</td>
<td class="gt_row gt_right">0.521</td>
<td class="gt_row gt_right">0.389</td>
<td class="gt_row gt_right">0.456</td>
<td class="gt_row gt_right">0.418</td>
<td class="gt_row gt_right">0.636</td>
<td class="gt_row gt_right">0.491</td>
<td class="gt_row gt_right">0.398</td>
<td class="gt_row gt_right">0.354</td>
<td class="gt_row gt_right">0.376</td>
<td class="gt_row gt_right">0.548</td>
<td class="gt_row gt_right">0.548</td>
<td class="gt_row gt_right">0.715</td>
<td class="gt_row gt_right">0.647</td>
<td class="gt_row gt_right">0.521</td>
<td class="gt_row gt_right">0.642</td>
<td class="gt_row gt_right">0.359</td>
<td class="gt_row gt_right">0.587</td>
<td class="gt_row gt_right">0.645</td>
<td class="gt_row gt_right">0.627</td>
<td class="gt_row gt_right">0.830</td>
<td class="gt_row gt_right">0.775</td>
<td class="gt_row gt_right">0.775</td>
<td class="gt_row gt_right">0.821</td>
<td class="gt_row gt_right">0.823</td>
<td class="gt_row gt_right">0.862</td>
<td class="gt_row gt_right">0.938</td>
<td class="gt_row gt_right">0.798</td>
<td class="gt_row gt_right">0.615</td>
<td class="gt_row gt_right">0.613</td>
<td class="gt_row gt_right">0.865</td>
<td class="gt_row gt_right">0.667</td>
<td class="gt_row gt_right">0.758</td>
<td class="gt_row gt_right">0.828</td>
<td class="gt_row gt_right">0.865</td>
<td class="gt_row gt_right">0.779</td>
<td class="gt_row gt_right">0.871</td>
<td class="gt_row gt_right">0.844</td>
<td class="gt_row gt_right">0.824</td>
<td class="gt_row gt_right">0.971</td>
<td class="gt_row gt_right">0.750</td>
<td class="gt_row gt_right">0.945</td>
<td class="gt_row gt_right">0.798</td>
<td class="gt_row gt_right">0.826</td>
<td class="gt_row gt_right">0.915</td>
<td class="gt_row gt_right">0.719</td>
<td class="gt_row gt_right">0.770</td>
<td class="gt_row gt_right">0.730</td>
<td class="gt_row gt_right">0.594</td>
<td class="gt_row gt_right">0.973</td>
<td class="gt_row gt_right">0.716</td>
<td class="gt_row gt_right">0.567</td>
<td class="gt_row gt_right">0.700</td></tr>
    <tr><td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0.564</td>
<td class="gt_row gt_right">0.593</td>
<td class="gt_row gt_right">0.544</td>
<td class="gt_row gt_right">0.426</td>
<td class="gt_row gt_right">0.299</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.197</td>
<td class="gt_row gt_right">0.355</td>
<td class="gt_row gt_right">0.578</td>
<td class="gt_row gt_right">0.243</td>
<td class="gt_row gt_right">0.468</td>
<td class="gt_row gt_right">0.303</td>
<td class="gt_row gt_right">0.373</td>
<td class="gt_row gt_right">0.331</td>
<td class="gt_row gt_right">0.650</td>
<td class="gt_row gt_right">0.497</td>
<td class="gt_row gt_right">0.485</td>
<td class="gt_row gt_right">0.327</td>
<td class="gt_row gt_right">0.437</td>
<td class="gt_row gt_right">0.440</td>
<td class="gt_row gt_right">0.344</td>
<td class="gt_row gt_right">0.339</td>
<td class="gt_row gt_right">0.559</td>
<td class="gt_row gt_right">0.529</td>
<td class="gt_row gt_right">0.512</td>
<td class="gt_row gt_right">0.404</td>
<td class="gt_row gt_right">0.377</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.531</td>
<td class="gt_row gt_right">0.626</td>
<td class="gt_row gt_right">0.622</td>
<td class="gt_row gt_right">0.536</td>
<td class="gt_row gt_right">0.617</td>
<td class="gt_row gt_right">0.360</td>
<td class="gt_row gt_right">0.481</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.534</td>
<td class="gt_row gt_right">0.819</td>
<td class="gt_row gt_right">0.782</td>
<td class="gt_row gt_right">0.831</td>
<td class="gt_row gt_right">0.869</td>
<td class="gt_row gt_right">0.874</td>
<td class="gt_row gt_right">0.838</td>
<td class="gt_row gt_right">0.911</td>
<td class="gt_row gt_right">0.793</td>
<td class="gt_row gt_right">0.565</td>
<td class="gt_row gt_right">0.558</td>
<td class="gt_row gt_right">0.857</td>
<td class="gt_row gt_right">0.696</td>
<td class="gt_row gt_right">0.821</td>
<td class="gt_row gt_right">0.840</td>
<td class="gt_row gt_right">0.857</td>
<td class="gt_row gt_right">0.831</td>
<td class="gt_row gt_right">0.907</td>
<td class="gt_row gt_right">0.873</td>
<td class="gt_row gt_right">0.880</td>
<td class="gt_row gt_right">0.972</td>
<td class="gt_row gt_right">0.806</td>
<td class="gt_row gt_right">0.940</td>
<td class="gt_row gt_right">0.863</td>
<td class="gt_row gt_right">0.873</td>
<td class="gt_row gt_right">0.919</td>
<td class="gt_row gt_right">0.641</td>
<td class="gt_row gt_right">0.825</td>
<td class="gt_row gt_right">0.757</td>
<td class="gt_row gt_right">0.631</td>
<td class="gt_row gt_right">0.972</td>
<td class="gt_row gt_right">0.781</td>
<td class="gt_row gt_right">0.537</td>
<td class="gt_row gt_right">0.733</td></tr>
  </tbody>
  
  
</table>
</div>

---

# Funciones de distancias en R


```r
# También se pueden calcular con la función base dist().
# El Método puede ser uno de los siguiente:
# "euclidean", "maximum", "manhattan", "canberra", "binary" or "minkowski".
dist(DF, method="Método")
```


```r
library(vegan)

# El Método puede ser uno de los siguiente:
# "manhattan", "euclidean", "canberra", "clark", "bray", "kulczynski", "jaccard", 
# "gower", "altGower", "morisita", "horn", "mountford", "raup", "binomial", "chao",  
# "cao", "mahalanobis", "chisq" "chord".
vegdist(DF, method="Método")
```

---
# Distancias Euclideanas

.pull-left[
Basado en el teorema de Pitágoras
$$ A^{2} = B^{2} + C^{2}$$

Lo que para efectos de la imagen, la distancia entre las observaciones `\(s_{j}\)` y `\(s_{i}\)`, basada en las variables `\(X\)` e `\(Y\)` es:

`$$d_{s_{j},s_{i}} = (X_j-X_i)^{2} + (Y_j-Y_i)^{2}$$`

`$$d_{s_{j},s_{i}} = \sqrt{(X_j-X_i)^{2} + (Y_j   -Y_i)^{2}}$$`

Para un espacio N-dimensional de `N` variables:

`$$d_{s_{j},s_{i}} = \sqrt{\sum_{n=1}^{N}(X_{jn}-X_{in})^{2}}$$`
]

.pull-right[
&lt;img src="figs/Euclidean.png" width="100%" style="display: block; margin: auto;" /&gt;

En un espacio N-dimensional `\(d_{s_{j},s_{i}}\)` es la distancia Euclideana.
]

---

Si consideramos las filas 20 y 21 de la tabla presentada inicialmente, tendremos:

<div id="wbjaahshwa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wbjaahshwa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wbjaahshwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wbjaahshwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wbjaahshwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbjaahshwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wbjaahshwa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wbjaahshwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wbjaahshwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wbjaahshwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wbjaahshwa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wbjaahshwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wbjaahshwa .gt_from_md > :first-child {
  margin-top: 0;
}

#wbjaahshwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wbjaahshwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wbjaahshwa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#wbjaahshwa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbjaahshwa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#wbjaahshwa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbjaahshwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wbjaahshwa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wbjaahshwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbjaahshwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#wbjaahshwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbjaahshwa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#wbjaahshwa .gt_left {
  text-align: left;
}

#wbjaahshwa .gt_center {
  text-align: center;
}

#wbjaahshwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wbjaahshwa .gt_font_normal {
  font-weight: normal;
}

#wbjaahshwa .gt_font_bold {
  font-weight: bold;
}

#wbjaahshwa .gt_font_italic {
  font-style: italic;
}

#wbjaahshwa .gt_super {
  font-size: 65%;
}

#wbjaahshwa .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Sitio</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">E</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Profundidad</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Polucion</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Temp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Sedimento</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">s20</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">73</td>
<td class="gt_row gt_right">5.6</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_left">S</td></tr>
    <tr><td class="gt_row gt_left">s21</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">59</td>
<td class="gt_row gt_right">4.3</td>
<td class="gt_row gt_right">3.4</td>
<td class="gt_row gt_left">C</td></tr>
  </tbody>
  
  
</table>
</div>

La distancia Euclideana, considerando tres variables: Profundidad, Polución, y Temperatura,
`$$\begin{equation} 
\begin{split}
d_{s_{j},s_{i}} &amp; = \sqrt{\sum_{n=1}^{N}(X_{jn}-X_{in})^{2}}\\
d_{s_{20},s_{21}} &amp; = \sqrt{(73-59)^{2}+(5.9-4.3)^{2}+(3.0-3.4)^{2}}\\
d_{s_{20},s_{21}} &amp; = \sqrt{196+2.56+0.16}\\
d_{s_{20},s_{21}} &amp; = \sqrt{198.72}\\
d_{s_{20},s_{21}} &amp; = 14.09\\
\end{split}
\end{equation}$$`

Este resultado representa el problema de que las variables tengan diferente escala de medición. **Solución:** transformar las variables de análisis.

---
class: middle, center 

&lt;img src="figs/Legendre Gallagher Transformations.jpg" width="80%" style="display: block; margin: auto;" /&gt;

.center[[Legendre, P., &amp; Gallagher, E. D. (2001). Ecologically meaningful &lt;br&gt;transformations for ordination of species data. Oecologia, 129(2), 271-280.](https://www.researchgate.net/publication/225701662_Ecologically_meaningful_transformations_for_ordination_of_species_data)]

---
class: middle, center 

&lt;img src="figs/Legendre Gallagher Transformations 2.jpg" width="100%" style="display: block; margin: auto;" /&gt;

---
class: middle, center 

&lt;img src="figs/Legendre Gallagher Transformations 3.jpg" width="80%" style="display: block; margin: auto;" /&gt;

---
class: middle, center 

&lt;img src="figs/Legendre Gallagher Transformations 4.jpg" width="70%" style="display: block; margin: auto;" /&gt;

---
class: middle, center 

&lt;img src="figs/Comparativo.png" width="100%" style="display: block; margin: auto;" /&gt;

---
# Medidas de distancias y transformaciones para: Var. ambientales

Si se desea aplicar un PCA:

1) **Distancia Euclideana, Manhattan, Minkowski.** 
  - Sobre matriz de datos continuos por naturaleza (mediciones de variables ambientales).
  - Es necesario estandarizar (centrar y escalar) las variables para evitar el error por la escala de medición de las variables.

---
# Medidas de distancias y transformaciones para: Abundancias-PCA

Si se desea aplicar PCA:

Implica trabajar en un espacio euclidiano con una matriz de datos de abundancias (conteos por naturaleza). Lógicamente, las matrices se deben transformar para evitar el problema de doble zeros:

2) **Distancia de Chord**
  - Equivale a aplicar a la matriz de abundancias la transformación de Chord y luego medir distancias euclideanas sobre ello.
  - Le da poco peso a las especies raras. Adecuado para PCA o RDA.

3) **Distancia de Hellinger**
  - Equivale a aplicar a la matriz de abundancias la transformación de Chord y luego medir distancias euclideanas sobre ello.
  - Le da poco peso, mucho menos que Chord, a las especies raras. Adecuado para PCA o RDA.
  
---
# Medidas de distancias y transformaciones para: Abundancias-CA

Si se desea aplicar CA:

Es el método típico a aplicar con matrices de biodiversidad (abundancias o presencia-ausencia)

4) **Distancia de Chi-cuadrado**
  - Equivale a aplicar a la matriz de abundancias la transformación de Chi-cuadrado y luego medir distancias euclideanas sobre ello.
  - Le da más peso a las especies raras. No tiene importancia en análisis multivariados interdependientes (PCA, CA), pero si cobra relevancia para multivariados dependientes (RDA, CCA).
  
  - Hacer un PCA con matriz de biodiversidad transformada con Chi-cuadrado equivale (pero no es idéntico) a hacer un CA sobre la matriz original de biodiversidad.

---
# Medidas de distancias y transformaciones para: Abundancias-MDS

Si se desea aplicar PCoA, también llamado MDS:


5) **Distancia de Bray-Curtis**
  - Es el método de distancias más clásico en ecología para matrices de biodiversidad.
  - Preserva la influencia de las abundancias en cada sitio.

---
# Medidas de distancias y transformaciones para: Binarios-NMDS

Estos métodos no son métricos, por lo que no pueden ser proyectados en un plano euclideano (No es posible PCA). No requiere transformación de las matrices de presencia-ausencia.


6) **Distancia de Sørensen-Dice**
 - El llamado Sørensen cualitativo. Es la versión de Bray-curtis para datos binarios.

$$J(A,B)=\frac{2 \times (A \cap B)}{(A \cup B)+(A \cap B)} = \frac{2 \times (A \cap B)}{|A|+|B|} $$

7) **Distancia de Jaccard**
  - Similar a Sørensen. Nació para comparar parcelas de flora con presencia-ausencia. No da tanto peso a las especies más comunes como Sørensen.
  
`$$J(A,B)= \frac{A \cap B}{A \cup B} = \frac{A \cap B}{|A|+|B|-{A \cap B}}$$`


---
class: middle, center 

&lt;img src="figs/legendre 2013.jpg" width="100%" style="display: block; margin: auto;" /&gt;

.center[[Legendre, P., &amp; De Cáceres, M. (2013). Beta diversity as the variance of &lt;br&gt;community data: dissimilarity coefficients and partitioning. Ecology letters, 16(8), 951-963.](http://adn.biol.umontreal.ca/~numericalecology/Reprints/Legendre_De_Caceres_ELE_2013_app.pdf)]

---
class: middle, center 

&lt;img src="figs/legendre 2013 PCA.jpg" width="50%" style="display: block; margin: auto;" /&gt;
Figure 2 Principal component biplot relating properties P4–P14 (red arrows) to the dissimilarity coefficients.

---
.pull-left[
### Tipo I:
- **Euclidean, Manhattan, Modiffied mean character difference, Species Profile.** son inapropiados para matrices de diversidad (abundancias) no transformadas.

### Tipo II:
- Distancias de **Hellinger y Chord** son adecuadas para  matrices de diversidad (abundancias) transformadas con Hellinger y Chord respectivamente.

### Tipo III: 
- Distancias **Canberra, Whittaker, Divergence, Bray-Curtis, Kulczyinki**, son adecuadas para  matrices de diversidad (abundancias)...
]

.pull-right[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
...Si hay valores muy altos entre las abundancias, es mejor logaritmizarlas para evitar darle peso excesivo.

### Tipo IV: 
- Distancias **cuantitativas** basadas en abundancias: **Jaccard, Sørensen, Ochiai**.

### Tipo V: 
- Distancia de **Chi-cuadrado** es inapropiado para matrices de diversidad (abundancias) cuando hay presencia de especies raras, en caso se desee realizar un CCA (análisis de correspondencia canónica). Para CA, no influencia de manera importante esta propiedad.
]
---

# Espacio Euclideano

.pull-left[
1. **.orange[En el espacio euclidiano:]** 
 
 - Sistema de coordenadas cartesiano que respeta y satisface los axiomas de Euclides. 
 
 - La distancia entre dos puntos se mide mediante una generalización del teorema de Pitágoras.

1. **.orange[En el espacio no euclidiano:]** 

 - La distancia medidas en estos espacios se mide mediante geometría esférica, hiperbólica, entre otras. 
 
 - Estas distancias no son comparables con lo observado en un espacio euclideano.

]

.pull-rigth[
&lt;img src="figs/eucli.png" width="40%" style="display: block; margin: auto;" /&gt;
]

---

# Espacio Euclideano y No Euclideano

--

&lt;img src="figs/Euclideano y no euclideano.jpg" width="60%" style="display: block; margin: auto;" /&gt;

--

&lt;img src="http://www.37steps.com/wp-content/uploads/2013/01/metric-euclidean.png" width="60%" style="display: block; margin: auto;" /&gt;

&lt;span, style= 'font-size:70%; text-align: center; display:block;'&gt;[Link Fig 1](http://www.drmarkliu.com/noneuclidean) |
[Link Fig 2](http://37steps.com/1617/non-euclidean-and-non-metric-dissimilarities/)&lt;/span&gt;

---

# Métrico y No Métrico

.pull-left[
Un concepto más general que "Euclideano y no Euclideano", es el concepto de distancias métricas y no. Las distancias Euclideanas son métricas.

Los axiomas matemático de los espacios métricos son ( `\(d_{ab}\)` es la distancia de "a" a "b"):

- `\(d_{ab} = d_{ba}\)` 

- `\(d_{ab} \ge 0\)` y es solamente 0 si `\(a = b\)` 

- `\(d_{ab} \le d_{ac} + d_{cb}\)` (Triangle inequality)
]

.pull-right[
&lt;img src="figs/Cuadrado.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Desarrollemos las secciones: 
### 1) Métodos de Transformación
### 2) Métodos de Distancias

<div class="countdown" id="timer_618bf969" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">20</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, middle, center , animated, slideInRight

# Métodos de Ordenamiento sin Restricciones
[ Clustering, CA, PCA, MDS, NMDS ]

---

.pull-left[

# Agrupamiento Jerárquico (Hierarchical Clustering)

- Una aplicación de las matrices de distancias es crear árboles de agrupamientos.

- Este no es un método estadístico (no hay contraste de hipótesis).

- Es una herramienta o técnica para identificar grupos o estructuras en los datos.
]

.pull-right[
&lt;br&gt;
&lt;br&gt; 
&lt;br&gt;
&lt;img src="figs/arbolini.png" width="140%" /&gt;
]

---

&lt;img src="figs/clustering.jpg" width="100%" /&gt;

---

background-image: url("figs/distmetodos.png")
background-size: cover

# Métodos de Aglomeración 

- Single linkage (a)

- Complete linkage (b)

- Average linkage o UPGMA (c)

- Método de Ward (Least Squares)

  [Link Figura](https://www.math-stat.unibe.ch/e237483/e237655/e243381/e281679/files281690/Chap11_ger.pdf)

---

# Desarrollemos la sección: 

### 3) Agrupamiento Jerárquico

<div class="countdown" id="timer_618bf75f" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">60</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Análisis de Correspondencia (CA)

- Es una extensión del PCA adecuado para relacionar los casos de dos variables categóricas (matriz de contingencia).

- Genera una decomposición de eigenvectores igual que en el PCA proyectando el resultado en un plano
métrico euclidiano. 

- La diferencia es que la distancia generada es la distancia de Chi-Cuadrado en lugar de la Euclidiana.


---

# Desarrollemos la sección: 

### 4) Análisis de Correspondencia (CA)

<div class="countdown" id="timer_618bf90d" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">25</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Análisis de Componentes Principales (PCA)

- El PCA es un método de reducción de dimensionalidad.
- Transforma un gran número de variables a un menor conjunto de variables no correlacionadas (ortogonales) llamadas Componentes Principales (PC).

.pull-left[
&lt;img src="figs/pca.gif" width="70%" style="display: block; margin: auto;" /&gt;
]

.pull-right[

&lt;img src="figs/pca intro.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Análisis de Componentes Principales (PCA)

- El PCA es un método de reducción de dimensionalidad.
- Transforma un gran número de variables a un menor conjunto de variables no correlacionadas (ortogonales) llamadas Componentes Principales (PC).

.pull-left[
1. **.red[Estandarizar la base de datos]** &lt;br&gt;( `\(\mu=0\)`, `\(\sigma^2=1\)`).
1. Cálculo de las matrices de covarianzas.
1. Cálculo de los eigenvectores y eigenvalores.
1. Reordenamiento de los eigenvalores y eigenvectores
1. Reproyectar los datos en los ejes principales.
]

.pull-right[


```r
scale(datos)
```
]

---

# Análisis de Componentes Principales (PCA)

- El PCA es un método de reducción de dimensionalidad.
- Transforma un gran número de variables a un menor conjunto de variables no correlacionadas (ortogonales) llamadas Componentes Principales (PC).

.pull-left[
1. Estandarizar la base de datos &lt;br&gt;( `\(\mu=0\)`, `\(\sigma^2=1\)`).
1. **.red[Cálculo de las matrices de covarianzas.]**
1. Cálculo de los eigenvectores y eigenvalores.
1. Reordenamiento de los eigenvalores y eigenvectores
1. Reproyectar los datos en los ejes principales.
]

.pull-right[

&lt;img src="figs/Corr.svg" width="90%" style="display: block; margin: auto;" /&gt;
&lt;img src="figs/cov matrix.jpeg" width="90%" style="display: block; margin: auto;" /&gt;
]

---

# Análisis de Componentes Principales (PCA)

- El PCA es un método de reducción de dimensionalidad.
- Transforma un gran número de variables a un menor conjunto de variables no correlacionadas (ortogonales) llamadas Componentes Principales (PC).

.pull-left[
1. Estandarizar la base de datos &lt;br&gt;( `\(\mu=0\)`, `\(\sigma^2=1\)`).
1. Cálculo de las matrices de covarianzas.
1. **.red[Cálculo de los eigenvectores y eigenvalores.]**
1. Reordenamiento de los eigenvalores y eigenvectores
1. Reproyectar los datos en los ejes principales.
]

.pull-right[


```r
eigen(cov(scale(DF)))
```
.scroll-box-14[

```
## eigen() decomposition
## $values
## [1] 1.4237444 0.9917002 0.5845554
## 
## $vectors
##            [,1]        [,2]       [,3]
## [1,] -0.1396642  0.99004058 0.01770777
## [2,] -0.6993188 -0.11128145 0.70609465
## [3,]  0.7010329  0.08623276 0.70789603
```
]
]

---

# Análisis de Componentes Principales (PCA)

El PCA es un método de reducción de dimensionalidad que se utiliza a menudo para reducir la dimensionalidad de grandes conjuntos de datos, transformando un gran conjunto de variables en uno  
pequeño que aún contiene la mayor parte de la información del conjunto grande.

1. Estandarizar la base de datos ( `\(\mu=0\)`, `\(\sigma^2=1\)`).
1. Cálculo de las matrices de covarianzas.
1. Cálculo de los eigenvectores y eigenvalores.
1. **.red[Reordenamiento de los eigenvalores y eigenvectores]**
1. Reproyectar los datos en los ejes principales.


```r
pca
```


```
## Standard deviations (1, .., p=3):
## [1] 1.1932076 0.9958414 0.7645623
## 
## Rotation (n x k) = (3 x 3):
##               PC1         PC2        PC3
## Aspect  0.1396642  0.99004058 0.01770777
## Slope   0.6993188 -0.11128145 0.70609465
## Snow   -0.7010329  0.08623276 0.70789603
```

---

# Desarrollemos la sección: 

### 5) Análisis de Componentes Principales (PCA)

<div class="countdown" id="timer_618bfa5c" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">60</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Análisis de Coordenadas Principales (MDS)

- Conocida como Escalamiento Multidimensional Métrico.

- PCA conserva  distancias euclidianas entre las muestras y CA las distancias chi-cuadrado, PCoA proporciona una representación euclidiana de un conjunto de objetos cuya relación se mide mediante cualquier método de distancias. 

- Tanto PCA y CA y PCoA devuelven un conjunto de ejes ortogonales.

## Eigenvalores negativos
En caso de utilizar un índice de distancia que no sea métrico, el PCoA puede producir ejes con valores propios negativos que no se pueden trazar. Soluciones:

  1. Convertir la distancia no métrica a métrica mediante transformación **.red[(BC + sqrt = métrica).]**
  2. Utilizar correcciones para evitar eigenvectores no negativos **.red[(e.g. lingoes).]**
  3. PCoA no proyecta las columnas de la tabla (especies), solo observaciones, pero podemos aplicar código para extraer esa información en R.
  
---

# Desarrollemos la sección: 

### 6) Análisis de Coordenadas Principales (PCoA, MDS)

<div class="countdown" id="timer_618bf95e" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">60</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


# Escalamiento Multidimensional No Métrico (NMDS)

- Es muy útil cuando queremos **.red[representar en 2D las relaciones entre observaciones]**, siendo que obtuvimos un PCA o PCoA que nos indicaban que 3 a más dimensiones eran necesarias para capturar un gran porcentaje de la variabilidad (&gt;50%).

- Es **.red[más robusto que el PCoA]** cuando se tiene que representar datos que no sean adecuados para un PCA (principalmente datos de conteos)

- Utiliza un algoritmo iterativo aleatorio, no paramétrico, para hallar con “prueba y error” la mejor posición para los puntos (la solución final). **.red[No se basa en descomposición de los eigenvalores como el PCA]**.

- No está restringido a un tipo de matriz de distancia, **.red[acepta cualquier matriz de distancia]**.

---

# Estrés del NMDS

.pull-left[

- Como regla general, el valor del estrés del NMDS deberá ser interpretado como

 - `≤0.05` = ideal

 - `&lt;0.1` y `&gt;0.05` = bueno

 - `&gt;0.1` y `&lt;0.2` = muy justo

 - `&gt;0.2` y `&lt;0.3` = sospechoso

 - `&gt;0.3` = ordenamiento arbitrario.

]

.pull-right[

&lt;img src="figs/nmds2.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Desarrollemos la sección: 

### 7) Escalamiento Multidimensional No Métrico (NMDS)

<div class="countdown" id="timer_618bfa7e" style="right:0;bottom:0;left:0;margin:12%;padding:50px;font-size:6em;" data-warnwhen="30">
<code class="countdown-time"><span class="countdown-digits minutes">60</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
class: middle, center

.center[# Gracias por tu atención]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="assets/remark-0.14.0.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "atom-one-light",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(https://raw.githubusercontent.com/irwingss/IrwingRLab/master/escudo.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  bottom: 1em;
  left: 4em;
  width: 25px;
  height: 25px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
